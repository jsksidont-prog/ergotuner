<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>ErgoTablature</title>
<style>
  :root{
    --bg:#ffffff;
    --fg:#0b0b0c;
    --brand:#10b981;
    --brand-2:#059669;
    --panel:#f3f4f6;
    --border:#e5e7eb;
    --shadow:0 6px 18px rgba(0,0,0,.12);
    --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    --header-h: 120px;              /* fallback; diset dinamis via JS */
    --main-gap: 16px;               /* jarak antara header dan konten */
    --maxw: 1000px;
  }

  *{box-sizing:border-box;}
  html,body{height:100%;}
  body{
    margin:0;
    font-family:var(--mono);
    background:
      linear-gradient(rgba(255,255,255,0.6) , rgba(255,255,255,0.85)),
      url("paris.png") no-repeat center center fixed;
    background-size: cover;
    background-attachment: fixed;
    color:#000;
    position: relative; /* anchor untuk absolute children */
    overflow-x:hidden;
  }

  /* ===== Header: ABSOLUTE, tanpa border ===== */
  header{
    position:absolute;
    top:0; left:0; right:0;
    width:100%;
    padding:22px 0 12px;
    text-align:center;
    z-index:80;
    
    /* no border */
    /* no box-shadow kalau mau super flat; kalau mau bayangan, uncomment: */
    /* box-shadow: var(--shadow); */
  }
  .title-wrapper{
    display:inline-flex; align-items:center; justify-content:center; gap:12px;
  }
  .title-wrapper img{ width:48px; height:48px; object-fit:contain; }
  header h1{
    font-size:2.4rem; font-weight:900; margin:0; color:#000; letter-spacing:.5px;
  }
  .toolbar{
    margin-top:14px; display:flex; flex-wrap:wrap; justify-content:center; gap:10px;
  }
  button.btn{
    display:inline-flex; align-items:center; gap:6px;
    padding:10px 14px; border:none; border-radius:8px; font-weight:700; cursor:pointer;
    transition:transform .1s ease, box-shadow .2s ease;
  }
  button.btn:hover{ transform:translateY(-2px);}
  .btn.download{background:linear-gradient(45deg,var(--brand),var(--brand-2)); color:#fff;}
  .btn.secondary{background:#f1f5f9; color:#000;}
  .btn.preview{background:linear-gradient(45deg,#16a34a,#22c55e); color:#fff;}

  /* ===== Konten utama: ABSOLUTE di bawah header ===== */
  main{
    position:absolute;
    left:50%;
    top: calc(var(--header-h) + var(--main-gap));
    transform: translateX(-50%);
    width: min(100% - 24px, var(--maxw));
    z-index:10;
  }
  .panel{
    width:100%;
    background:var(--panel);
    border-radius:10px;
    border:1px solid var(--border);
    box-shadow:var(--shadow);
    overflow-x:auto;
    padding:15px;
  }
  .tab-container{ white-space:pre; font-family:var(--mono); line-height:1.3em; font-size:15px; }
  .string-label{ margin-right:6px; font-weight:700; color:#6b7280; }
  .note{
    display:inline-block; min-width:1.1ch; text-align:center; cursor:pointer; border-radius:3px; transition:background .12s;
  }
  .note:hover{ background:rgba(0,0,0,0.08); }

  /* ===== Hamburger & Menu: persis seperti kode kedua ===== */
  .hamburger-wrap{
    position: fixed;
    top: 14px;
    left: 14px;
    z-index: 100; /* pastikan selalu di atas header */
  }
  .hamburger{
    width:40px; height:32px;
    background:#fff;
    border:1px solid #ccc;
    border-radius:6px;
    display:flex; align-items:center; justify-content:center;
    cursor:pointer;
  }
  .hamburger .bar{
    width:20px; height:2px; background:#000;
    position:relative;
  }
  .hamburger .bar::before,
  .hamburger .bar::after{
    content:"";
    position:absolute;
    left:0; width:20px; height:2px; background:#000;
  }
  .hamburger .bar::before{ top:-6px; }
  .hamburger .bar::after{ top:6px; }

  .overlay{
    position:fixed; inset:0;
    background:rgba(0,0,0,0.4);
    opacity:0; pointer-events:none;
    transition:0.2s;
    z-index:90;
  }
  .overlay.show{ opacity:1; pointer-events:auto; }

  .menu-panel{
    position: fixed;
    top: 0; left: 0;
    width:220px;
    height:100%;
    background:#fff;
    box-shadow:2px 0 10px rgba(0,0,0,0.3);
    transform:translateX(-100%);
    transition:0.3s;
    z-index:95;
    padding-top:60px;
    text-align:left;
  }
  .menu-panel.show{ transform:translateX(0); }

  .menu-item{
    display:block;
    padding:12px 18px;
    text-decoration:none;
    color:#000;
    border-radius:6px;
    transition:0.3s;
    font-size:16px;
  }
  .menu-item:hover{ background:#f76c6c; color:#fff; }

  /* Responsif kecil: kasih ruang header sedikit lebih tinggi */
  @media (max-width: 420px){
    header h1{ font-size: 2rem; }
  }
</style>
</head>
<body>

<!-- Hamburger -->
<div class="hamburger-wrap">
  <div class="hamburger" id="hambtn" aria-label="Buka menu" aria-controls="menuPanel" aria-expanded="false">
    <span class="bar"></span>
  </div>
</div>
<div class="overlay" id="overlay" aria-hidden="true"></div>

<!-- Panel menu -->
<nav id="menuPanel" class="menu-panel" aria-hidden="true">
  <a class="menu-item" href="index.html">Home</a>
  <a class="menu-item" href="h.html">Chord</a>
  <a class="menu-item" href="1312.html">Preset</a>
  <a class="menu-item" href="metro.html">Metronom</a>
  <a class="menu-item" href="TAB.html">Tab Maker</a>
  <a class="menu-item" href="EQWEQWQWE1.html">Scale Guitar</a>
  <a class="menu-item" href="coba.html">Progresi Chord</a>
  <a class="menu-item" href="chatbot.html">ChatBot</a>
  <a class="menu-item" href="https://craftpix.net/?s=FARM" target="_blank" rel="noopener">Download my App</a>
</nav>

<!-- Header (absolute) -->
<header id="siteHeader">
  <div class="title-wrapper">
    <img src="ERGOPANTEK.png" alt="Logo ErgoTablature">
    <h1>ErgoTab</h1>
  </div>
  <div class="toolbar">
    <button class="btn download" id="downloadBtn">Download</button>
    <button class="btn secondary" id="copyBtn">Copy</button>
    <button class="btn secondary" id="clearBtn">Bersihkan</button>
    <button class="btn secondary" id="addRowBtn">Tambah Baris</button>
    <button class="btn preview" id="previewBtn">Preview</button>
  </div>
</header>

<!-- Konten utama (absolute, auto-offset dari header) -->
<main id="main">
  <div class="panel">
    <div id="tabContainer" class="tab-container"></div>
  </div>
</main>

<script>
/* ===== Set tinggi header -> geser main biar nggak nabrak ===== */
(function setHeaderHeight(){
  const header = document.getElementById('siteHeader');
  function apply(){
    const h = header.offsetHeight; // hitung tinggi aktual
    document.documentElement.style.setProperty('--header-h', h + 'px');
  }
  // jalankan saat siap & saat resize/orientasi berubah
  window.addEventListener('load', apply);
  window.addEventListener('resize', apply);
  // juga saat font/icon sudah ter-load
  setTimeout(apply, 200);
})();

/* ===== Hamburger (klik, overlay, ESC) ===== */
(function(){
  const btn = document.getElementById('hambtn');
  const panel = document.getElementById('menuPanel');
  const overlay = document.getElementById('overlay');

  function openMenu(){
    panel.classList.add('show');
    overlay.classList.add('show');
    btn.setAttribute('aria-expanded','true');
    panel.setAttribute('aria-hidden','false');
    overlay.setAttribute('aria-hidden','false');
  }
  function closeMenu(){
    panel.classList.remove('show');
    overlay.classList.remove('show');
    btn.setAttribute('aria-expanded','false');
    panel.setAttribute('aria-hidden','true');
    overlay.setAttribute('aria-hidden','true');
  }
  function toggleMenu(){
    panel.classList.contains('show') ? closeMenu() : openMenu();
  }

  btn.addEventListener('click', toggleMenu);
  overlay.addEventListener('click', closeMenu);
  panel.addEventListener('click', e=>{
    if(e.target.classList.contains('menu-item')) closeMenu();
  });
  window.addEventListener('keydown', e=>{
    if(e.key === 'Escape') closeMenu();
  });
})();

/* ===== Logic Tab Maker milikmu ===== */
let numStrings = 6;
let numPositions = 30;
let names = ['e','B','G','D','A','E'];
let tabRows = [];
let context = new (window.AudioContext || window.webkitAudioContext)();
const baseFreqs = [329.63, 246.94, 196.00, 146.83, 110.00, 82.41];

function createEmptyBar(){return Array(numStrings).fill().map(()=>Array(numPositions).fill('-'));}
tabRows.push(createEmptyBar());
const tabContainer = document.getElementById('tabContainer');

function renderTab(){
  let html='';
  tabRows.forEach((tab, barIndex)=>{
    for(let s=numStrings-1; s>=0; s--){
      html += `<span class="string-label">${names[s]}</span>|`;
      for(let i=0;i<numPositions;i++){
        const val = tab[numStrings-1 - s][i];
        html += `<span class="note" data-bar="${barIndex}" data-string="${numStrings-1 - s}" data-pos="${i}">${val}</span>`;
      }
      html += '|<br>';
    }
    html += '<br>';
  });
  tabContainer.innerHTML = html;
}
tabContainer.addEventListener('click', e=>{
  if(e.target.classList.contains('note')){
    const bar=parseInt(e.target.dataset.bar);
    const s=parseInt(e.target.dataset.string);
    const p=parseInt(e.target.dataset.pos);
    const current=tabRows[bar][s][p];
    const fret=prompt('Masukkan nomor fret (0-24):', current==='-'?'0':current);
    if(fret!==null){tabRows[bar][s][p]=fret===''?'-':fret; renderTab();}
  }
});

function buildPlainText(){
  let text='';
  tabRows.forEach(tab=>{
    for(let s=numStrings-1; s>=0; s--){
      text+=names[s]+'|';
      for(let i=0;i<numPositions;i++){text+=tab[numStrings-1 - s][i];}
      text+='|\n';
    }
    text+='\n';
  });
  return text;
}
function downloadTab(){
  const text=buildPlainText();
  const blob=new Blob([text],{type:'text/plain'});
  const link=document.createElement('a');
  link.href=URL.createObjectURL(blob);
  link.download='tab.txt';
  link.click();
}
function copyTab(){navigator.clipboard.writeText(buildPlainText());}
function clearTab(){tabRows=[createEmptyBar()]; renderTab();}
function addRow(){tabRows.push(createEmptyBar()); renderTab();}

function playGuitarAcoustic(freq,startTime,duration){
  const gainNode=context.createGain();
  gainNode.connect(context.destination);
  const osc1=context.createOscillator();
  osc1.type='sine'; osc1.frequency.value=freq; osc1.connect(gainNode);
  const osc2=context.createOscillator();
  osc2.type='triangle'; osc2.frequency.value=freq*2; osc2.connect(gainNode);
  const osc3=context.createOscillator();
  osc3.type='sawtooth'; osc3.frequency.value=freq*0.5; osc3.connect(gainNode);
  gainNode.gain.setValueAtTime(0,startTime);
  gainNode.gain.linearRampToValueAtTime(0.8,startTime+0.01);
  gainNode.gain.exponentialRampToValueAtTime(0.4,startTime+duration*0.3);
  gainNode.gain.setValueAtTime(0.4,startTime+duration*0.7);
  gainNode.gain.exponentialRampToValueAtTime(0.001,startTime+duration);
  osc1.start(startTime); osc1.stop(startTime+duration+0.05);
  osc2.start(startTime); osc2.stop(startTime+duration+0.05);
  osc3.start(startTime); osc3.stop(startTime+duration+0.05);
}

function previewTab(){
  const positionDuration=0.4;
  const restDuration=0.05;
  let delay=0;
  const now=context.currentTime;
  tabRows.forEach(tab=>{
    for(let i=0;i<numPositions;i++){
      const hasNote=tab.some((stringArr)=>stringArr[i]!=='-');
      const duration=hasNote?positionDuration:restDuration;
      tab.forEach((stringArr,s)=>{
        const val=stringArr[i];
        if(val!=='-'){
          const fret=parseInt(val);
          const freq=baseFreqs[s]*Math.pow(2,fret/12);
          playGuitarAcoustic(freq,now+delay,duration);
        }
      });
      delay+=duration;
    }
  });
}

document.getElementById('downloadBtn').onclick=downloadTab;
document.getElementById('copyBtn').onclick=copyTab;
document.getElementById('clearBtn').onclick=clearTab;
document.getElementById('addRowBtn').onclick=addRow;
document.getElementById('previewBtn').onclick=previewTab;

renderTab();
</script>

</body>
</html>
